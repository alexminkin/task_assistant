# yt-kb: Автоматизация публикации требований БФТ в YouTrack

## Описание

Этот репозиторий предназначен для автоматизации подготовки, структурирования и публикации требований по шаблону БФТ (Best Functional Template) в базу знаний YouTrack.  
Вся работа строится на строгом следовании шаблону, централизованных правилах для аналитиков и использовании CLI-утилиты и slash-команд Cursor.

## Основные возможности

- **Строгие правила для всех ролей** (product, business_analyst, system_analyst) — оформление и доработка требований только по шаблону `templates/bft/content.md`, без додумывания архитектуры, интеграций и платформ.
- **База знаний** — папка `knowledge/` содержит стандарты, архитектуру, бизнес-процессы, метрики, полные справочники API и др.
- **Гибкая работа с шаблонами** — шаблоны документов хранятся в `templates/`, рабочие копии — в `workspace/`.
- **CLI-утилита** — для инициализации, импорта, синхронизации и публикации документов.
- **Slash-команды Cursor** — для автоматизированного анализа, аудита и обогащения требований прямо в редакторе.

## Структура проекта

```plaintext
yt-kb/
├── .cursor/            # Правила и команды для Cursor (mdc, rules.json)
│   └── rules/
│       ├── business_analyst.mdc
│       ├── system_analyst.mdc
│       ├── product.mdc
│       └── common.mdc
├── knowledge/          # База знаний проекта (архитектура, API, метрики и др.)
├── templates/          # Шаблоны документов (например, BFT)
│   └── bft/
│       ├── content.md
│       ├── config.json
│       └── attachments/
├── workspace/          # Рабочие копии документов
│   └── <doc_name>/
│       ├── config.json
│       ├── content.md
│       └── attachments/
├── cli.py              # CLI-утилита (init, import, sync, publish, new-bft)
├── requirements.txt    # Зависимости проекта
├── .env                # Переменные окружения (YT_TOKEN, YT_BASE_URL, PROJECT_ID, PARENT_ID)
└── README.md           # Документация проекта
```

## База знаний (`knowledge/`)

- **architecture.md** — архитектурные принципы компании
- **api-standards.md** — стандарты REST API, форматы, коды, валидация
- **data-models.md** — описание моделей данных и связей
- **platform-guidelines.md** — гайдлайны по платформе, стек, DevOps
- **business-processes.md** — стандарты и примеры бизнес-процессов
- **market-research.md** — маркетинговые исследования, конкуренты, SWOT
- **product-metrics.md** — основные и дополнительные метрики продукта
- **API_FULL_TABLE.md** — полный справочник всех API-методов

## Шаблон требований БФТ

- Основной шаблон: `templates/bft/content.md`
- Строгая структура: цель, проблематика, метрики, user stories, архитектура, API, тестирование, ограничения, риски и др.
- Все требования должны быть оформлены и дорабатываться только по этому шаблону.

## Правила и команды Cursor

- Все правила для ролей и универсальные команды описаны в `.cursor/rules/*.mdc` и `.cursor/rules.json`.
- **Ключевые команды:**
  - `/suggest improvements` — аудит требований, рекомендации по структуре и полноте (универсальная команда)
  - `/enrich requirements` — обогащение архитектурой и API (по запросу)
  - `/check architecture`, `/check platforms`, `/improve functionalRequirements` и др. — для отдельных аспектов требований

**Важно:**  
- Нельзя додумывать архитектуру, интеграции, платформы, если они не указаны явно.
- Перед изменениями всегда перечитывать существующие требования, не дублировать и не затирать данные.
- Все новые элементы добавлять только по прямому запросу пользователя или при их явном наличии в требованиях.

## Работа с документами

### Создание нового документа

1. Инициализация из шаблона:
   ```bash
   python3 cli.py init bft <doc_name>
   ```
2. Заполнение `config.json` и редактирование `content.md` по шаблону.
3. Добавление вложений в `attachments/` (файл `.gitkeep` не загружается).
4. Публикация в YouTrack:
   ```bash
   python3 cli.py publish <doc_name>
   ```

### Импорт и синхронизация

- Импорт из YouTrack:
  ```bash
  python3 cli.py import "<ID_или_URL_статьи>" "<имя_папки>"
  ```
- Синхронизация с последней версией:
  ```bash
  python3 cli.py sync "<имя_папки>"
  ```

### Быстрое создание и публикация БФТ-документа

```bash
python3 cli.py new-bft "Название документа"
```
— создаёт папку, структуру и сразу публикует статью в YT.

## Настройка окружения

1. Клонируйте репозиторий:
   ```bash
   git clone # укажите ссылку на репозиторий
   cd yt-kb
   ```
2. Установите зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Создайте `.env` с переменными:
   ```env
   YT_TOKEN=ваш_токен
   YT_BASE_URL="сслыка на youtrack"
   PROJECT_ID=0-2
   PARENT_ID=146-106
   ```

## Работа через Cursor (slash-команды)

- Все команды работают только в интерактивном интерфейсе Cursor.
- Команды автоматически применяют правки в файле `workspace/<doc_name>/content.md` согласно правилам из `.cursor/rules/` и `.cursor/rules.json`.

**Примеры команд:**
- `/suggest improvements` — аудит и рекомендации по улучшению требований
- `/enrich requirements` — добавить архитектурные требования и API (по шаблону)
- `/check architecture` — сверить архитектуру с корпоративными стандартами
- `/improve functionalRequirements` — улучшить функциональные требования

## Примеры slash-команд для работы с требованиями

Ниже приведены примеры универсальных команд, которые можно использовать в Cursor для автоматизации создания, дополнения и проверки требований по шаблону БФТ:

### Генерация и дополнение разделов требований

- `/generate goal` — сформировать раздел «Цель»
- `/generate problem` — сформировать раздел «Проблематика»
- `/generate businessValue` — сформировать раздел «Польза для бизнеса»
- `/generate userValue` — сформировать раздел «Польза для юзера»
- `/generate metrics` — сформировать раздел «Метрики»
- `/generate glossary` — собрать и оформить раздел терминов и сокращений
- `/generate background` — сформировать раздел Background (Product)
- `/generate userStories` — сгенерировать список user stories
- `/generate acceptanceCriteria` — сформировать критерии приемки для всех user stories
- `/generate functionalRequirements` — сформировать функциональные требования (ФТ)
- `/generate nonFunctionalRequirements` — сформировать нефункциональные требования
- `/generate architecture` — сформировать раздел «Архитектурные требования»
- `/generate apiSection` — сформировать раздел API
- `/generate dataModels` — сформировать описание моделей данных
- `/generate integrations` — сформировать раздел интеграций
- `/generate testCases` — сформировать тестовые сценарии и критерии приемки
- `/generate risks` — сформировать раздел ограничений и рисков

### Проверка и аудит структуры требований

- `/check completeness` — проверить заполненность всех обязательных разделов
- `/check acceptanceCriteria` — проверить наличие и корректность критериев приемки
- `/check glossary` — проверить раздел терминов и сокращений
- `/check metrics` — проверить раздел метрик
- `/check risks` — проверить раздел ограничений и рисков
- `/check testCases` — проверить тестовые сценарии и критерии приемки
- `/check attachments` — проверить корректность ссылок на вложения и их наличие
- `/check designReferences` — проверить ссылки на дизайн-макеты и пояснения к ним
- `/check apiExamples` — проверить наличие примеров запросов/ответов для API
- `/check dataModels` — проверить описание моделей данных
- `/check integrations` — проверить раздел интеграций
- `/check businessValue` — проверить разделы «Польза для бизнеса» и «Польза для юзера»
- `/check background` — проверить раздел Background (Product)
- `/check structure` — проверить соответствие структуры документа шаблону БФТ
- `/check formatting` — проверить оформление таблиц, списков, заголовков

**Пример использования:**

- Для генерации user stories: `/generate userStories`
- Для проверки полноты документа: `/check completeness`
- Для автоматического сбора терминов: `/generate glossary`
- Для аудита критериев приемки: `/check acceptanceCriteria`

## Важно

- Все требования должны быть структурированы и дорабатываться только по шаблону БФТ.
- Любые изменения проходят через аудит и рекомендации, автоматизированные команды и строгие правила для всех ролей.
- База знаний и шаблоны всегда актуальны и централизованы.

## Команды CLI

- `python3 cli.py init <template> <doc_name>`  
  Инициализировать новый документ из указанного шаблона (например, `bft`).

- `python3 cli.py publish <doc_name>`  
  Опубликовать или обновить документ в YouTrack (загружает вложения, обновляет ссылки).

- `python3 cli.py new-bft "<Название>"`  
  Создать и сразу опубликовать новый БФТ-документ (папка будет `[Драфт] БФТ <Название>`).

- `python3 cli.py import <ID_или_URL_статьи> <doc_name>`  
  Импортировать существующий документ из YouTrack по ID или URL (загружает вложения, обновляет ссылки).

- `python3 cli.py sync <doc_name>`  
  Синхронизировать локальный документ с последней версией из YouTrack (обновляет текст и вложения).

**Примеры:**
```bash
python3 cli.py init bft my_doc
python3 cli.py publish my_doc
python3 cli.py new-bft "Система уведомлений"
python3 cli.py import RC-A-123 my_doc
python3 cli.py sync my_doc
```
